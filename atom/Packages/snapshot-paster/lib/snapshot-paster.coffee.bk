fsp = require('fs-plus');
path = require('path');
mkdirp = require('mkdirp');
clipboard = require('clipboard');

module.exports =
  activate: ->
    atom.workspaceView.command "snapshot-paster:paste", => @paste

  paste: ->
      editor = atom.workspace.activePaneItem;
      selection = editor.getSelection();

      selection.insertText("TestImage " + atom.project.getPath() + " " + path.join('path', 'to', 'file.txt') + " ");
      image = clipboard.readImage();

      if !image.isEmpty()
        #selection.insertText("IMG-Meta: " + image.toPng());
        fsp.writeFileSync(atom.project.getPath() + "/test.png", image.toPng(), 'base64');


        #({
        #  referenceDir: function() {
        #    var homeDir;
        #    homeDir = process.env.HOME || process.env.HOMEPATH || process.env.USERPROFILE;
        #    return atom.project.getPath() || homeDir;
        #  }

      # sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAiZmlsZSI6ICIiLAogICJzb3VyY2VSb290IjogIiIsCiAgInNvdXJjZXMiOiBbCiAgICAiIgogIF0sCiAgIm5hbWVzIjogW10sCiAgIm1hcHBpbmdzIjogIkFBQUE7QUFBQSxNQUFBLDRCQUFBOztBQUFBLEVBQUEsR0FBQSxHQUFNLE9BQUEsQ0FBUSxTQUFSLENBQU4sQ0FBQTs7QUFBQSxFQUNBLElBQUEsR0FBTyxPQUFBLENBQVEsTUFBUixDQURQLENBQUE7O0FBQUEsRUFFQSxNQUFBLEdBQVMsT0FBQSxDQUFRLFFBQVIsQ0FGVCxDQUFBOztBQUFBLEVBR0EsU0FBQSxHQUFZLE9BQUEsQ0FBUSxXQUFSLENBSFosQ0FBQTs7QUFBQSxFQUtBLE1BQU0sQ0FBQyxPQUFQLEdBQ0U7QUFBQSxJQUFBLFFBQUEsRUFBVSxTQUFBLEdBQUE7YUFDUixJQUFJLENBQUMsYUFBYSxDQUFDLE9BQW5CLENBQTJCLHVCQUEzQixFQUFvRCxDQUFBLFNBQUEsS0FBQSxHQUFBO2VBQUEsU0FBQSxHQUFBO2lCQUFHLEtBQUMsQ0FBQSxLQUFELENBQUEsRUFBSDtRQUFBLEVBQUE7TUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQXBELEVBRFE7SUFBQSxDQUFWO0FBQUEsSUFHQSxLQUFBLEVBQU8sU0FBQSxHQUFBO0FBQ0wsVUFBQSx3QkFBQTtBQUFBLE1BQUEsTUFBQSxHQUFTLElBQUksQ0FBQyxTQUFTLENBQUMsY0FBeEIsQ0FBQTtBQUFBLE1BQ0EsU0FBQSxHQUFZLE1BQU0sQ0FBQyxZQUFQLENBQUEsQ0FEWixDQUFBO0FBQUEsTUFHQSxTQUFTLENBQUMsVUFBVixDQUFxQixZQUFBLEdBQWUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFiLENBQUEsQ0FBZixHQUF3QyxHQUF4QyxHQUE4QyxJQUFJLENBQUMsSUFBTCxDQUFVLE1BQVYsRUFBaUIsSUFBakIsRUFBc0IsVUFBdEIsQ0FBOUMsR0FBa0YsR0FBdkcsQ0FIQSxDQUFBO0FBQUEsTUFTQSxLQUFBLEdBQVEsU0FBUyxDQUFDLFNBQVYsQ0FBQSxDQVRSLENBQUE7QUFVQSxNQUFBLElBQUcsQ0FBQSxLQUFNLENBQUMsT0FBTixDQUFBLENBQUo7QUFDRSxRQUFBLFNBQVMsQ0FBQyxVQUFWLENBQXFCLFlBQUEsR0FBZSxLQUFLLENBQUMsS0FBTixDQUFBLENBQXBDLENBQUEsQ0FBQTtlQUNBLEdBQUcsQ0FBQyxhQUFKLENBQWtCLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBYixDQUFBLENBQUEsR0FBMEIsV0FBNUMsRUFBd0QsS0FBSyxDQUFDLEtBQU4sQ0FBQSxDQUF4RCxFQUFzRSxRQUF0RSxFQUZGO09BWEs7SUFBQSxDQUhQO0dBTkYsQ0FBQTs7QUFBQSxFQXdCQyxDQUFBO0FBQUEsSUFBQSxZQUFBLEVBQWMsU0FBQSxHQUFBO0FBQ1gsVUFBQSxPQUFBO0FBQUEsTUFBQSxPQUFBLEdBQVUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFaLElBQW9CLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBaEMsSUFBNEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFsRSxDQUFBO2FBQ0EsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFiLENBQUEsQ0FBQSxJQUEwQixRQUZmO0lBQUEsQ0FBZDtHQUFBLENBeEJELENBQUE7QUFBQSIKfQ==
      # sourceURL=/home/dani/github/snapshot-paster/lib/snapshot-paster.coffee
